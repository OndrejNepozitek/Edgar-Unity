"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6242],{603905:function(e,t,o){o.d(t,{Zo:function(){return d},kt:function(){return m}});var n=o(667294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var s=n.createContext({}),c=function(e){var t=n.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},d=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),h=c(o),m=a,u=h["".concat(s,".").concat(m)]||h[m]||p[m]||r;return o?n.createElement(u,i(i({ref:t},d),{},{components:o})):n.createElement(u,i({ref:t},d))}));function m(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,i=new Array(r);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var c=2;c<r;c++)i[c]=o[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}h.displayName="MDXCreateElement"},57040:function(e,t,o){o.r(t),o.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return d},default:function(){return f}});var n=o(487462),a=o(263366),r=(o(667294),o(603905)),i=["components"],l={title:"Different room/door elevations"},s=void 0,c={unversionedId:"3d/guides/different-elevations",id:"version-2.0.5/3d/guides/different-elevations",title:"Different room/door elevations",description:"While it is not possible to have a level where one room is on top of another room (multi-story generation), it is possible to have rooms at different elevation levels (y axis). The goal of this guide is to show you how to control the elevation of rooms and what needs to be done if there are cycles/loops in a level graph.",source:"@site/versioned_docs/version-2.0.5/3d/guides/different-elevations.md",sourceDirName:"3d/guides",slug:"/3d/guides/different-elevations",permalink:"/Edgar-Unity/docs/2.0.5/3d/guides/different-elevations",editUrl:"https://github.com/OndrejNepozitek/Edgar-Unity/tree/docusaurus/versioned_docs/version-2.0.5/3d/guides/different-elevations.md",tags:[],version:"2.0.5",frontMatter:{title:"Different room/door elevations"},sidebar:"3d",previous:{title:"Dungeon 1",permalink:"/Edgar-Unity/docs/2.0.5/3d/examples/dungeon-1"},next:{title:"Door sockets",permalink:"/Edgar-Unity/docs/2.0.5/3d/guides/door-sockets"}},d=[{value:"Basics",id:"basics",children:[],level:2},{value:"Cycles in level graphs (and their challenges)",id:"cycles-in-level-graphs-and-their-challenges",children:[],level:2},{value:"Option 1: Avoid elevation changes inside cycles",id:"option-1-avoid-elevation-changes-inside-cycles",children:[],level:2},{value:"Option 2: Door sockets for different elevations",id:"option-2-door-sockets-for-different-elevations",children:[],level:2},{value:"Option 3: Manual elevation-changing corridors",id:"option-3-manual-elevation-changing-corridors",children:[],level:2}],p=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",t)}},h=p("Image"),m=p("Path"),u=p("Gallery"),g={toc:d};function f(e){var t=e.components,o=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,n.Z)({},g,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"While it is not possible to have a level where one room is on top of another room (multi-story generation), it is possible to have rooms at different elevation levels (y axis). The goal of this guide is to show you how to control the elevation of rooms and ",(0,r.kt)("strong",{parentName:"p"},"what needs to be done if there are cycles/loops in a level graph"),"."),(0,r.kt)(h,{src:"3d/guides/different_elevations/intro.png",caption:"Side view example of a very simple level where the next room is always 1 meter higher than the previous one (caused by the corridor with a purple ramp)",mdxType:"Image"}),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Note:")," All files from this example can be found at ",(0,r.kt)(m,{path:"3de:DifferentElevations",mdxType:"Path"}),".")),(0,r.kt)("h2",{id:"basics"},"Basics"),(0,r.kt)("p",null,"The core idea of having rooms at different elevation levels is relatively simple. You just have to place doors that are positioned at different ",(0,r.kt)("em",{parentName:"p"},"y coordinates")," and the generator will try to figure out the correct elevation of each room. The end goal is that if two rooms are connected by doors, the doors must align correctly in all three dimensions. If that means that one room needs to be higher than another one, the generator will position the room for you."),(0,r.kt)(u,{cols:2,fixedHeight:!0,mdxType:"Gallery"},(0,r.kt)(h,{src:"3d/guides/different_elevations/corridor_example.png",caption:"Corridor room template with different door elevations",mdxType:"Image"}),(0,r.kt)(h,{src:"3d/guides/different_elevations/room_example.png",caption:"Room template with different door elevations",mdxType:"Image"})),(0,r.kt)("p",null,"If you use the two room templates above to generate a level, you will get something similar to what you can see in the image below. You can see that all the doors are properly aligned to the doors of the neighbouring rooms/corridors."),(0,r.kt)(h,{src:"3d/guides/different_elevations/basic_result.png",caption:"Example of an acyclic level with doors (and rooms) at different elevation levels",mdxType:"Image"}),(0,r.kt)("h2",{id:"cycles-in-level-graphs-and-their-challenges"},"Cycles in level graphs (and their challenges)"),(0,r.kt)("p",null,"The above example worked out-of-the-box because there were no cycles (loops) in the corresponding level graph. The problem is that the underlying generator algorithm works completely in 2D, which means that it does not know/care about elevations of individual loops. When there are no loops, the problem is quite simple. We can go through the rooms in a clever order and just fix their elevations one by one. "),(0,r.kt)("p",null,"But imagine that you have a cycle in your level graph - I will use the level graph below as an example. There is a cycle with 6 rooms. If you are unlucky, the generator can randomly choose that the next room is always 1 meter higher than the previous room. That means that ",(0,r.kt)("em",{parentName:"p"},"Room 1")," would be positioned at ",(0,r.kt)("em",{parentName:"p"},"y = 0")," and ",(0,r.kt)("em",{parentName:"p"},"Room 6")," at ",(0,r.kt)("em",{parentName:"p"},"y = 5"),". If that happens, the generator cannot connect rooms 1 and 6 and will throw an exception. Moreover, the generator can sometimes succeed and sometimes fail, depending on which combination of room templates it randomly chooses."),(0,r.kt)(h,{src:"3d/guides/different_elevations/cycle_graph.png",caption:"Problematic level graph with a cycle",mdxType:"Image"}),(0,r.kt)(u,{cols:2,fixedHeight:!0,mdxType:"Gallery"},(0,r.kt)(h,{src:"3d/guides/different_elevations/cycle_wrong.png",caption:"Unlucky attempt - Exactly 1 elevation-changing corridor was chosen, making it impossible to fix room elevations",mdxType:"Image"}),(0,r.kt)(h,{src:"3d/guides/different_elevations/cycle_correct.png",caption:"Lucky attempt - 2 elevation-changing corridors with good orientations were chosen, producing a valid level",mdxType:"Image"})),(0,r.kt)("p",null,"The rest of this guide is dedicated to various strategies of having different elevations while using level graphs with cycles."),(0,r.kt)("h2",{id:"option-1-avoid-elevation-changes-inside-cycles"},"Option 1: Avoid elevation changes inside cycles"),(0,r.kt)("p",null,"The simplest (and also the most restrictive) solution is to completely avoid all elevation changes for rooms and corridors that are inside level graph cycles. This can be done automatically by ticking the ",(0,r.kt)("inlineCode",{parentName:"p"},"FixElevationsInsideCycles")," checkbox inside the ",(0,r.kt)("inlineCode",{parentName:"p"},"Input Config")," section of the dungeon generation, or by manually calling ",(0,r.kt)("inlineCode",{parentName:"p"},"levelDescription.FixElevationsInsideCycles();")," if using custom input setup. What this is feature does is that it finds all the room templates with potential elevation changes and bans them for rooms and corridors that are inside cycles. "),(0,r.kt)("p",null,"The obvious downside of this solution is that you will end up with no elevation changes insides cycles, which may or may not be desirable based on your level design."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Note:")," With this approach, you have to make sure that you provide enough room templates without any elevation changes for both rooms and corridors.")),(0,r.kt)(h,{src:"3d/guides/different_elevations/no_elevations_inside_cycles_result.png",caption:"Example level with no elevation changes inside the central cycle",mdxType:"Image"}),(0,r.kt)("h2",{id:"option-2-door-sockets-for-different-elevations"},"Option 2: Door sockets for different elevations"),(0,r.kt)("p",null,"Another possible approach is to use door sockets to mark doors at different elevations. The main idea is that the number of different elevation levels is limited. For example, you might have Elevation 0 (ground level) and Elevation 1 (1 meter above ground). Next, create a door socket for each elevation level and assign these sockets to doors based on their elevations. Below is an example of a few room templates using this approach."),(0,r.kt)(u,{cols:2,fixedHeight:!0,mdxType:"Gallery"},(0,r.kt)(h,{src:"3d/guides/different_elevations/sockets_room_1.png",caption:"Room template that connects Elevation 0 and Elevation 1",mdxType:"Image"}),(0,r.kt)(h,{src:"3d/guides/different_elevations/sockets_room_2.png",caption:"Room template that is completely at Elevation 1",mdxType:"Image"}),(0,r.kt)(h,{src:"3d/guides/different_elevations/sockets_corridor_1.png",caption:"Corridor that connects Elevation 0 and Elevation 1",mdxType:"Image"}),(0,r.kt)(h,{src:"3d/guides/different_elevations/sockets_corridor_2.png",caption:"Corridor 'bridge' that is completely at Elevation 1",mdxType:"Image"})),(0,r.kt)("p",null,"This approach can never lead to generating a level with incorrect elevations because the whole problem was basically transformed to the problem of socket resolution. You can see an example generated level below."),(0,r.kt)(h,{src:"3d/guides/different_elevations/sockets_result.png",caption:"Example cyclic level generated using door sockets marking different elevations",mdxType:"Image"}),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Note:")," This approach should be used only if you have a very limited number of different elevation levels, ideally only ",(0,r.kt)("em",{parentName:"p"},"2")," (the same as in the example above) or at most 3.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Note:")," It is easy to force different parts of the level to be at different elevations. Just pick two rooms in the level graph and give them room templates with different elevations, forcing the generator to work with that.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Note:")," Make sure to provide enough room templates for all elevation levels and also enough transition room templates that go from one elevation to another.")),(0,r.kt)("h2",{id:"option-3-manual-elevation-changing-corridors"},"Option 3: Manual elevation-changing corridors"),(0,r.kt)("p",null,"Another possible approach is to manually place corridors that connect rooms with different elevations. For this guide, I will assume that only corridor can have doors at different elevations."),(0,r.kt)("p",null,"The first step is to create an elevation-changing corridor. For this approach to work, you also have to mark one door (e.g. the lower one) as ",(0,r.kt)("em",{parentName:"p"},"Entrance")," and the other one (the upper one) as ",(0,r.kt)("em",{parentName:"p"},"Exit"),". The result should look like this:"),(0,r.kt)(h,{src:"3d/guides/different_elevations/directed_corridor.png",caption:"Elevation-changing corridor with the lower door marked as Entrance and the upper door marked as Exit.",mdxType:"Image"}),(0,r.kt)("p",null,"Next, create a level graph but make sure to enable the ",(0,r.kt)("inlineCode",{parentName:"p"},"Is Directed")," checkbox. Then, when creating a cycle in the level graph, orient the edges so that they go in the direction of increasing (or more precise ",(0,r.kt)("em",{parentName:"p"},"non-decreasing"),") elevation. My level graph looks like this:"),(0,r.kt)(h,{src:"3d/guides/different_elevations/directed_level_graph.png",caption:"Cyclic level graph which is oriented to go from low elevations in Room 1 to higher elevations in Room 4",mdxType:"Image"}),(0,r.kt)("p",null,"With this level graph, we basically want to say that ",(0,r.kt)("em",{parentName:"p"},"Room 4")," should be positioned higher than ",(0,r.kt)("em",{parentName:"p"},"Room 1"),". The way we will achieve that is by manually picking some of the oriented connections and telling the generator that the corridor room template from the previous step must be used."),(0,r.kt)("p",null,"For this guide, I choose the connection ",(0,r.kt)("em",{parentName:"p"},"Room 1")," -> ",(0,r.kt)("em",{parentName:"p"},"Room 2")," to go 1 meter up, and assigned the correct room template. However, if you choose one connection to go up, you also need to pick another one to go down. Therefore, I did the same setup for the connection ",(0,r.kt)("em",{parentName:"p"},"Room 1")," -> ",(0,r.kt)("em",{parentName:"p"},"Room 6")," to balance the height differences."),(0,r.kt)(h,{src:"3d/guides/different_elevations/directed_result_1.png",caption:"Result of assigning the elevation-changing room template for the corridors leading from Room 1 (bottom-left)",mdxType:"Image"}),(0,r.kt)("p",null,"You are not limited to have only 2 elevation-changing corridors in the whole cycle - you can use any number, just make sure that you always balance the number of corridors going up and down. Below you can see an example of also changing elevations for connections ",(0,r.kt)("em",{parentName:"p"},"Room 3")," -> ",(0,r.kt)("em",{parentName:"p"},"Room 4")," and ",(0,r.kt)("em",{parentName:"p"},"Room 5")," -> ",(0,r.kt)("em",{parentName:"p"},"Room 4"),"."),(0,r.kt)(h,{src:"3d/guides/different_elevations/directed_result_2.png",caption:"Result of a setup with 2 pairs of elevation-changing corridors",mdxType:"Image"}),(0,r.kt)("p",null,"When done correctly, this approach also ensures that all the generated levels have correct elevation changes."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Note:")," This approach is harder to set up than the previous approaches. But if you really want to go this way, you can use a custom input setup and randomize which connections are elevation-changing.")))}f.isMDXComponent=!0}}]);